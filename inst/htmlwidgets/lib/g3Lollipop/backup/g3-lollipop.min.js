!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3")):"function"==typeof define&&define.amd?define(["exports","d3"],e):e(t.g3=t.g3||{},t.d3)}(this,function(t,e){"use strict";function n(t,e){var n=(document.getElementById("canvas")||document.createElement("canvas")).getContext("2d");return n.font=e,n.measureText(t).width}function r(t,e){return t=t||1e5,e=e||1e6-1,Math.floor(Math.random()*(e-t)+t)}e=e&&e.hasOwnProperty("default")?e.default:e;var a={bottlerocket1:["#A42820","#5F5647","#9B110E","#3F5151","#4E2A1E","#550307","#0C1707"],bottlerocket2:["#FAD510","#CB2314","#273046","#354823","#1E1E1E"],rushmore1:["#E1BD6D","#F2300F","#35274A","#EABE94","#0B775E"],royal1:["#899DA4","#C93312","#FAEFD1","#DC863B"],royal2:["#9A8822","#F5CDB4","#F8AFA8","#FDDDA0","#74A089"],zissou1:["#3B9AB2","#78B7C5","#EBCC2A","#E1AF00","#F21A00"],darjeeling1:["#FF0000","#00A08A","#F2AD00","#F98400","#5BBCD6"],darjeeling2:["#ECCBAE","#046C9A","#D69C4E","#ABDDDE","#000000"],chevalier1:["#446455","#FDD262","#D3DDDC","#C7B19C"],fantasticfox1:["#DD8D29","#E2D200","#46ACC8","#E58601","#B40F20"],moonrise1:["#F3DF6C","#CEAB07","#D5D5D3","#24281A"],moonrise2:["#798E87","#C27D38","#CCC591","#29211F"],moonrise3:["#85D4E3","#F4B5BD","#9C964A","#CDC08C","#FAD77B"],cavalcanti1:["#D8B70A","#02401B","#A2A475","#81A88D","#972D15"],grandbudapest1:["#F1BB7B","#FD6467","#5B1A18","#D67236"],grandbudapest2:["#E6A0C4","#C6CDF7","#D8A499","#7294D4"],google16:["#3366cc","#dc3912","#ff9900","#109618","#990099","#0099c6","#dd4477","#66aa00","#b82e2e","#316395","#994499","#22aa99","#aaaa11","#6633cc","#e67300","#8b0707","#651067","#329262","#5574a6","#3b3eac"],google5:["#008744","#0057e7","#d62d20","#ffa700","#ffffff"],material1:["#263238","#212121","#3e2723","#dd2c00","#ff6d00","#ffab00","#ffd600","#aeea00","#64dd17","#00c853","#00bfa5","#00b8d4","#0091ea","#2962ff","#304ffe","#6200ea","#aa00ff","#c51162","#d50000"],pie1:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99"],pie2:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"],pie3:["#495769","#A0C2BB","#F4A775","#F4C667","#F37361"],pie4:["#FA7921","#E55934","#9BC53D","#FDE74C","#5BC0EB"],pie5:["#5DA5DA","#4D4D4D","#60BD68","#B2912F","#B276B2","#F15854","#FAA43A"],pie6:["#537ea2","#42a593","#9f1a1a","#7c5f95","#61a070"],pie7:["#bddff9","#1e72bf","#ead1ab","#a2dbc5","#c7ae7d"],breakfast:["#b6411a","#eec3d8","#4182dd","#ecf0c8","#2d6328"],set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],category10:["#1f77b4","#2ca02c","#d62728","#ff7f0e","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"],pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#bf5b17","#386cb0","#f0027f","#666666"],dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"]};function o(){return a.google16}function i(t){return t in a?a[t]:o}function l(t){return e.scaleOrdinal(i(t))}var s=s||function(t){if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=t.document,n=function(){return t.URL||t.webkitURL||t},r=e.createElementNS("http://www.w3.org/1999/xhtml","a"),a="download"in r,o=/constructor/i.test(t.HTMLElement)||t.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent),l=t.setImmediate||t.setTimeout,s=function(t){l(function(){throw t},0)},c=function(t){setTimeout(function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()},4e4)},u=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},p=function(e,p,d){d||(e=u(e));var f,m=this,g="application/octet-stream"===e.type,h=function(){!function(t,e,n){for(var r=(e=[].concat(e)).length;r--;){var a=t["on"+e[r]];if("function"==typeof a)try{a.call(t,n||t)}catch(t){s(t)}}}(m,"writestart progress write writeend".split(" "))};if(m.readyState=m.INIT,a)return f=n().createObjectURL(e),void l(function(){var t,e;r.href=f,r.download=p,t=r,e=new MouseEvent("click"),t.dispatchEvent(e),h(),c(f),m.readyState=m.DONE},0);!function(){if((i||g&&o)&&t.FileReader){var r=new FileReader;return r.onloadend=function(){var e=i?r.result:r.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,m.readyState=m.DONE,h()},r.readAsDataURL(e),void(m.readyState=m.INIT)}f||(f=n().createObjectURL(e)),g?t.location.href=f:t.open(f,"_blank")||(t.location.href=f);m.readyState=m.DONE,h(),c(f)}()},d=p.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,n){return e=e||t.name||"download",n||(t=u(t)),navigator.msSaveOrOpenBlob(t,e)}:(d.abort=function(){},d.readyState=d.INIT=0,d.WRITING=1,d.DONE=2,d.error=d.onwritestart=d.onprogress=d.onwrite=d.onabort=d.onerror=d.onwriteend=null,function(t,e,n){return new p(t,e||t.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||void 0);function c(t,r,a){var o=!0,i={left:10,right:0,top:5,bottom:5},l=e.dispatch("legendClick","legendDblclick","legendMouseover","legendMouseout");t=t||"svg",r=r||!1,a=a||[];var s=0,c="normal 12px sans-serif",u="black",p="bold 12px sans-serif",d="black";return{set target(e){t=e},get target(){return t},set title(t){r=t},get title(){return r},set series(t){a=t},get series(){return a},set margin(t){i=t},get margin(){return i},set dispatch(t){l=t},get dispatch(){return l},set interactive(t){o=t},get interactive(){return o},set labelFont(t){c=t},get labelFont(){return c},set labelColor(t){u=t},get labelColor(){return u},set titleFont(t){p=t},get titleFont(){return p},set titleColor(t){d=t},get titleColor(){return d},get height(){return s},addSeries:function(t){t.key in Object.keys(a)||a.push(t)},getLegendStatus:function(){return a.map(function(t){return{key:t.key,status:t._status||!0}})},destroy:function(){e.select(".g3-legend").selectAll("*").remove()},draw:function(){a.forEach(t=>t._status=!0);let f=e.select(t),m=+f.attr("width"),g=+f.attr("height"),h=m-(i.left||0)-(i.right||0),b=f.append("g").attr("class","g3-legend").attr("transform","translate("+i.left+","+(g+i.top)+")"),y=r?n(r,p):0,x=Math.min(y+6,1/3*h),v=h-x,w={x:0,y:8},k={x:0,y:8};r&&b.append("g").attr("class","g3-legend-title").append("text").attr("x",x-6).attr("y",8).attr("text-anchor","end").attr("fill",d).style("font",p).attr("dy","0.35em").text(r);b.append("g").attr("class","g3-legend-item-container").attr("transform","translate("+x+", 0)").selectAll(".g3-legend-item").data(a).enter().append("g").attr("class","g3 g3-legend-item").style("cursor",o?"pointer":"default").each(function(t){let r=e.select(this),a=t.value.label||t.key;var i;i=n(a,c),(i+=23)>v-k.x?(w.x=0,w.y=k.y+16,k.x=i,k.y=w.y):(w.x=k.x,k.x+=i);let s=w.x+12+3,p=w.y;r.attr("state","enabled").attr("defaultColor",t.value.fill),r.append("circle").attr("cx",s).attr("cy",p).attr("r",3).attr("fill",t.value.fill||"transparent").attr("stroke-width",1).attr("stroke","grey"),s+=8,r.append("text").attr("x",s).attr("y",p).attr("text-anchor","start").attr("fill",u).style("font",c).attr("dy","0.35em").text(a),r.on("click",function(){var e,n,a,i;o&&(n=(e=r).attr("defaultColor"),a=e.select("circle"),i=e.select("text"),"enabled"==e.attr("state")?(e.attr("state","disabled"),a.attr("fill","transparent").attr("stroke",n),i.style("opacity",.5)):(e.attr("state","enabled"),a.attr("fill",n).attr("stroke","grey"),i.style("opacity",1)),l.call("legendClick",this,t.key,"enabled"==r.attr("state")),t._status="enabled"==r.attr("state"))})}),s=i.top+w.y+8+i.bottom,f.attr("height",s+g)}}}function u(){var t=function(){return"n"},n=function(){return[0,0]},r=function(){return" "},a=document.body,o=d(),i=null,l=null,s=null;function c(t){var e;e=t.node(),(i=e?"svg"===e.tagName.toLowerCase()?e:e.ownerSVGElement:null)&&(l=i.createSVGPoint(),a.appendChild(o))}c.show=function(){var e=Array.prototype.slice.call(arguments);e[e.length-1]instanceof SVGElement&&(s=e.pop());var o,i=r.apply(this,e),l=n.apply(this,e),d=t.apply(this,e),m=f(),g=p.length,h=document.documentElement.scrollTop||a.scrollTop,b=document.documentElement.scrollLeft||a.scrollLeft;for(m.html(i).style("opacity",1).style("pointer-events","all");g--;)m.classed(p[g],!1);return o=u.get(d).apply(this),m.classed(d,!0).style("top",o.top+l[0]+h+"px").style("left",o.left+l[1]+b+"px"),c},c.hide=function(){return f().style("opacity",0).style("pointer-events","none"),c},c.attr=function(t,n){if(arguments.length<2&&"string"==typeof t)return f().attr(t);var r=Array.prototype.slice.call(arguments);return e.selection.prototype.attr.apply(f(),r),c},c.style=function(t,n){if(arguments.length<2&&"string"==typeof t)return f().style(t);var r=Array.prototype.slice.call(arguments);return e.selection.prototype.style.apply(f(),r),c},c.direction=function(e){return arguments.length?(t=null==e?e:g(e),c):t},c.offset=function(t){return arguments.length?(n=null==t?t:g(t),c):n},c.html=function(t){return arguments.length?(r=null==t?t:g(t),c):r},c.rootElement=function(t){return arguments.length?(a=null==t?t:g(t),c):a},c.destroy=function(){return o&&(f().remove(),o=null),c};var u=e.map({n:function(){var t=m(this);return{top:t.n.y-o.offsetHeight,left:t.n.x-o.offsetWidth/2}},s:function(){var t=m(this);return{top:t.s.y,left:t.s.x-o.offsetWidth/2}},e:function(){var t=m(this);return{top:t.e.y-o.offsetHeight/2,left:t.e.x}},w:function(){var t=m(this);return{top:t.w.y-o.offsetHeight/2,left:t.w.x-o.offsetWidth}},nw:function(){var t=m(this);return{top:t.nw.y-o.offsetHeight,left:t.nw.x-o.offsetWidth}},ne:function(){var t=m(this);return{top:t.ne.y-o.offsetHeight,left:t.ne.x}},sw:function(){var t=m(this);return{top:t.sw.y,left:t.sw.x-o.offsetWidth}},se:function(){var t=m(this);return{top:t.se.y,left:t.se.x}}}),p=u.keys();function d(){var t=e.select(document.createElement("div"));return t.style("position","absolute").style("top",0).style("opacity",0).style("pointer-events","none").style("box-sizing","border-box"),t.node()}function f(){return null==o&&(o=d(),a.appendChild(o)),e.select(o)}function m(t){for(var n=s||e.event.target;null==n.getScreenCTM&&null!=n.parentNode;)n=n.parentNode;var r={},a=n.getScreenCTM(),o=n.getBBox(),i=o.width,c=o.height,u=o.x,p=o.y;return l.x=u,l.y=p,r.nw=l.matrixTransform(a),l.x+=i,r.ne=l.matrixTransform(a),l.y+=c,r.se=l.matrixTransform(a),l.x-=i,r.sw=l.matrixTransform(a),l.y-=c/2,r.w=l.matrixTransform(a),l.x+=i,r.e=l.matrixTransform(a),l.x-=i/2,l.y-=c/2,r.n=l.matrixTransform(a),l.y+=c,r.s=l.matrixTransform(a),r}function g(t){return"function"==typeof t?t:function(){return t}}return c}t.getTextWidth=n,t.getUniqueID=r,t.palettes=a,t.defaultPalette=o,t.getPalette=i,t.listPalettes=function(){return Object.keys(a)},t.scaleOrdinal=l,t.output=function(){function t(t,e){return(t=t||n)+"."+e}function e(t){t.setAttribute("xmlns","http://www.w3.org/2000/svg"),t.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),function(t,e){var n=document.createElement("style");n.setAttribute("type","text/css"),n.innerHTML=t;var r=e.hasChildNodes()?e.children[0]:null;e.insertBefore(n,r)}(function(t){var e=[];e.push("#"+t.id);for(let n=0;n<t.classList.length;n++)c("."+t.classList[n],e)||e.push("."+t.classList[n]);var n=t.getElementsByTagName("*");for(let t=0;t<n.length;t++){var r=n[t].id;c("#"+r,e)||e.push("#"+r);var a=n[t].classList;for(let t=0;t<a.length;t++)c("."+a[t],e)||e.push("."+a[t])}var o="";for(let t=0;t<document.styleSheets.length;t++){var i=document.styleSheets[t];try{if(!i.cssRules)continue}catch(t){if("SecurityError"!==t.name)throw t;continue}for(var l=i.cssRules,s=0;s<l.length;s++)c(l[s].selectorText,e)&&(o+=l[s].cssText)}return o;function c(t,e){return-1!==e.indexOf(t)}}(t),t);var e=(new XMLSerializer).serializeToString(t);return e=(e=e.replace(/(\w+)?:?xlink=/g,"xmlns:xlink=")).replace(/NS\d+:href/g,"xlink:href")}var n="output",r="svg";function a(t){r=t||r}return a.toSVG=function(n){n=t(n,"svg");var a=e(document.querySelector(r)),o=new Blob([a],{type:"image/svg+xml"});s(o,n)},a.toPNG=function(n){n=t(n,"png");var a=document.querySelector(r),o=+a.getAttribute("width"),i=+a.getAttribute("height"),l=e(a),c="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(l))),u=document.createElement("canvas");u.width=o,u.height=i;var p=u.getContext("2d"),d=new Image;d.src=c,d.onload=function(){p.clearRect(0,0,o,i),p.drawImage(d,0,0,o,i),u.toBlob(function(t){s(t,n)})}},a},t.legend=c,t.tooltip=u,t.Lollipop=function(t,a,o){const i="g3_lollipop",s={circle:0,pie:1},p={x:"AA_Position",y:"Protein_Change",factor:"Mutation_Class"},d={symbol:"hgnc_symbol",name:"protein_name",length:"length",domainType:"pfam",details:{start:"pfam_start",end:"pfam_end",ac:"pfam_ac",name:"pfam_id"}};t=t||"svg",o=o||800,(a=a||"circle")in s||(a="circle");var f,m,g,h,b,y,x,v,w,k,C,S,T,L,A,D,_,E,N,F,B,M,P,z,O,I,R,H,j,W,U,V,$,q=r(),G={chartID:i+"_"+q,className:"g3-chart",tooltip:!0,margin:{left:40,right:20,top:15,bottom:25},background:"transparent",transitionTime:600,legend:!0,legendOpt:{margin:{},interactive:!0,title:"__undefined__"}},Y={id:i+"-main-"+q,defsId:i+"-main-defs-"+q,xAxisDefsId:i+"-xAxis-defs-"+q,height:420,background:"rgb(244,244,244)",lollipopClassName:{group:"lollipop",line:"lollipopLine",pop:"pop"},lollipopLine:{stroke:"rgb(42,42,42)","stroke-width":.5},popClassName:{pie:"popPie",slice:"pieSlice",text:"popText",circle:"popCircle",label:"popLabel"},popCircle:{stroke:"wheat","stroke-width":.5},popText:{fill:"#EEE","font-family":"Sans","font-weight":"normal","text-anchor":"middle",dy:"0.35em"},popLabel:{"font-family":"Arial","font-weight":"normal",minFontSize:10,fontsizeToRadius:1.4,padding:5},popColorScheme:l("accent"),yPaddingRatio:1.1,popParams:{rMin:2,rMax:12,addNumRCutoff:8,yLowerQuantile:.25,yUpperQuantile:.99},title:{id:"g3-chart-title",text:"",font:"normal 16px Arial",color:"#424242",alignment:"middle",dy:"0.35em"},axisLabel:{font:"normal 12px Arial",fill:"#4f4f4f","text-anchor":"middle",dy:"-2em",alignment:"middle"},ylab:{text:"mutations"}},X={id:i+"-domain-"+q,defsId:i+"-annotation-defs-"+q,height:30,margin:{top:4,bottom:0},background:"transparent",className:{track:"domain_track",bar:"domain_bar",domain:i+"_domain",brush:"domain-x-brush",zoom:"main-viz-zoom"},domain:{colorScheme:l("category10"),margin:{top:0,bottom:0},label:{font:"normal 11px Arial",color:"#f2f2f2"}},bar:{background:"#e5e3e1",margin:{top:2,bottom:2}},brush:!0,zoom:!0},Q=[],J={},K=p,Z=d,tt=!1,et=[],nt=null,rt=!1,at=!1,ot={},it=function(t){return st(t)-lt(t)},lt=function(t){return L(t[Z.details.start])},st=function(t){return L(t[Z.details.end])},ct=function(){L.domain(T),_.call(A),k.attr("x",function(t){return lt(t)}).attr("width",function(t){return it(t)}),C.attr("x",function(t){return(lt(t)+st(t))/2}),y.attr("x1",function(t){return pt(t)}).attr("x2",function(t){return pt(t)}),x.attr("transform",function(t){return"translate("+pt(t)+","+dt(t)+")"})},ut=function(){if(e.event.sourceEvent&&"zoom"===e.event.sourceEvent.type)return;let t=e.event.selection||O.range();T=t.map(O.invert),X.zoom&&g.select(".main-viz-zoom").call(I.transform,e.zoomIdentity.scale(U/(t[1]-t[0])).translate(-t[0],0)),ct()},pt=function(t){return L(t.position)},dt=function(t){return N(t._currentState.count)},ft=function(t){let e=t._currentState.count;return 0==e?0:e>=v?Y.popParams.rMax:e<=w?Y.popParams.rMin:(e-w)/(v-w)*(Y.popParams.rMax-Y.popParams.rMin)+Y.popParams.rMin},mt=function(t){let n="";return at?(n+=`<div class="note">\n            <table class="pure-table pure-table-bordered">\n                <caption> Position ${t.position} </caption>\n                <thead>\n                    <tr>\n                        <th scope="col">Class</th>\n                        <th scope="col">#</th>\n                        <th scope="col">Change</th>\n                        <th scope="col">&#37;</th>\n                    </tr>\n                </thead>\n                <tbody>`,t._currentState.summary.forEach(function(r){r.value.count>0&&(n+=`\n                    <tr>\n                        <th scope="row"> ${r.key} </th>\n                        <td> ${r.value.count} </td>\n                        <td>`+gt(r.value.byY)+"</td>\n                        <td>"+e.format(".1f")(r.value.count/t._currentState.count*100)+"&#37;</td>\n                    </tr>")}),n+="\n                </tbody>\n            </table></div>"):(n+=`\n            <table class="pure-table pure-table-bordered">\n                <caption> Position ${t.position} </caption>\n                <thead>\n                    <tr>\n                        <th scope="col">Change</th>\n                        <th scope="col">&#37;</th>\n                    </tr>\n                </thead>\n                <tbody>`,t._currentState.summary[0].value.byY.forEach(function(r){n+=`\n                    <tr>\n                        <th> ${r.key} </th>\n                        <td>`+e.format(".1f")(r.value/t._currentState.count*100)+"&#37;</td>\n                    </tr>"}),n+="\n                </tbody>\n            </table>"),n},gt=function(t){var e="";return t.forEach(function(t){e+=`${t.key} (n=${t.value})<br>`}),e},ht=function(t,e){G.tooltip&&nt.show(t,e)},bt=function(t){G.tooltip&&nt.hide(t)},yt=function(t){let e,n,r,a=-1;return t._currentState.summary.forEach(function(t){t.value.count>0&&t.value.count>a&&(e=t.value.byY[0].key,r=t,n=Y.popColorScheme(t.key),a=t.value.count)}),{class:r,entry:e,count:a,color:n}},xt=function(t,e){if(t._currentState.showLabel){t._currentState.showLabel=!1;let n=e.select("."+Y.popClassName.label);Nt(n.attr("yMaxValue"),-1),n.transition().duration(G.transitionTime).attr("transform","rotate(0)").remove()}else{t._currentState.showLabel=!0;let r=yt(t),a=Math.max(t._currentState.radius*Y.popLabel.fontsizeToRadius,Y.popLabel.minFontSize)+"px",o=Y.popLabel["font-weight"]+" "+a+" "+Y.popLabel["font-family"],i=n(r.entry,o),l=t._currentState.radius+Y.popLabel.padding+i,s=(E[1]-E[0])*(l/W),c=t._currentState.count+s;Nt(c,1),e.append("text").classed(Y.popClassName.label,!0).attr("x",-t._currentState.radius-Y.popLabel.padding).attr("y",0).attr("yMaxValue",c).text(r.entry).style("fill",r.color).style("font",o).attr("dy",".35em").attr("text-anchor","end").transition().duration(G.transitionTime).attr("transform","rotate(90)")}},vt=function(){return e.pie().sort(null)},wt=function(t){let n=e.select(this);t._currentState.showLabel&&(n.select("."+Y.popClassName.label).remove(),t._currentState.showLabel=!1);let r=t._currentState.radius=ft(t);switch(a){case"pie":!function(t,n,r){let a=e.arc().innerRadius(0).outerRadius(r),o=vt().value(function(t){return t.value.count}),i=n.select("."+Y.popClassName.pie).selectAll("path."+Y.popClassName.slice).data(o(t._currentState.summary));i.enter().insert("path"),i.transition().duration(G.transitionTime).attrTween("d",function(t){this._current=this._current||t;let n=e.interpolate(this._current,t);return this._current=n(0),function(t){return a(n(t))}}),i.exit().remove()}(t,n,r);break;default:!function(t,e,n){let r=e.select("."+Y.popClassName.circle),a=yt(t).color||"transparent";r.transition().duration(G.transitionTime).attr("r",n).attr("fill",a)}(t,n,r)}let o=n.select("."+Y.popClassName.text);if(r>=Y.popParams.addNumRCutoff){let e=kt(r,t._currentState.count,Y.popText["font-weight"],Y.popText["font-family"]),n=Y.popText["font-weight"]+" "+e+" "+Y.popText["font-family"];o.transition().duration(G.transitionTime).text(t._currentState.count).style("font",n)}else o.text("")},kt=function(t,e,r,a){let o=1.75*t;for(let t=Math.ceil(o);t>=0;t--)if(n(e,r+" "+t+"px "+a)<=o)return t+"px";return 0},Ct=function(t){let n=e.select(this),r=t._currentState.radius=ft(t);n.append("circle").attr("class",Y.popClassName.circle).attr("cx",0).attr("cy",0).attr("r",r).attr("stroke",Y.popCircle.stroke).attr("stroke-width",Y.popCircle["stroke-width"]).attr("fill","none");let a=e.arc().innerRadius(0).outerRadius(r),o=vt().value(function(t){return t.value.count}),i=n.append("g").attr("class",Y.popClassName.pie);i.selectAll(Y.popClassName.slice).data(o(t._currentState.summary)).enter().append("path").attr("d",a).attr("class",Y.popClassName.slice).attr("fill",function(t){return Y.popColorScheme(t.data.key)}),i.exit().remove();let l=n.append("text").attr("class",Y.popClassName.text).attr("fill",Y.popText.fill).style("font-family",Y.popText["font-family"]).style("font-weight",Y.popText["font-weight"]).attr("text-anchor",Y.popText["text-anchor"]).attr("dy",Y.popText.dy);if(r>=Y.popParams.addNumRCutoff){let e=kt(r,t._currentState.count,Y.popText["font-weight"],Y.popText["font-family"]);l.transition().duration(G.transitionTime).text(t._currentState.count).style("font-size",e)}else l.text("");n.on("mouseover",function(t){ht(t)}).on("mouseout",function(t){bt(t)}).on("click",function(t){xt(t,n)})},St=function(t){let n=e.select(this),r=t._currentState.radius=ft(t),a=yt(t);n.append("circle").attr("class",Y.popClassName.circle).attr("cx",0).attr("cy",0).attr("r",r).attr("stroke",Y.popCircle.stroke).attr("stroke-width",Y.popCircle["stroke-width"]).attr("fill",a.color);let o=n.append("text").attr("class",Y.popClassName.text).style("font-family",Y.popText["font-family"]).style("font-weight",Y.popText["font-weight"]).attr("text-anchor",Y.popText["text-anchor"]).attr("dy",Y.popText.dy);if(r>=Y.popParams.addNumRCutoff){let e=kt(r,t._currentState.count,Y.popText["font-weight"],Y.popText["font-family"]);o.transition().duration(G.transitionTime).text(t._currentState.count).attr("font-size",e)}else o.text("");n.on("mouseover",function(t){ht(t)}).on("mouseout",function(t){bt(t)}).on("click",function(t){xt(t,n)})},Tt=function(){switch(b=g.append("g").attr("class",Y.lollipopClassName.group),y=b.append("g").attr("clip-path","url(#"+Y.defsId+")").selectAll(Y.lollipopClassName.line).data(Q).enter().append("line").attr("x1",function(t){return pt(t)}).attr("x2",function(t){return pt(t)}).attr("y1",N(0)+X.margin.top).attr("y2",function(t){return dt(t)}).attr("class",Y.lollipopClassName.line).attr("stroke",Y.lollipopLine.stroke).attr("stroke-width",Y.lollipopLine["stroke-width"]),x=b.append("g").attr("clip-path","url(#"+Y.defsId+")").selectAll(Y.lollipopClassName.pop).data(Q).enter().append("g").attr("transform",function(t){return"translate("+pt(t)+","+dt(t)+")"}).classed(Y.lollipopClassName.pop,!0).attr("id",function(t,e){return i+"-"+q+"-lollipop-group-"+e}),a){case"pie":x.each(Ct);break;default:x.each(St)}let t,e,n;Y.title.text.length>0&&("start"==Y.title.alignment?(t="start",e=0):"middle"==Y.title.alignment?(t="middle",e=U/2):(t="end",e=U),n=-G.margin.top/2,g.append("text").attr("id",Y.title.id).style("font",Y.title.font).attr("fill",Y.title.color).attr("text-anchor",t).attr("alignment-base","alphabetic").attr("transform","translate("+e+","+n+")").attr("dy",Y.title.dy).text(Y.title.text))},Lt=function(){if(e.event.sourceEvent&&"brush"===e.event.sourceEvent.type)return;let t=e.event.transform;T=t.rescaleX(O).domain(),X.brush&&h.select("."+X.className.brush).call(z.move,O.range().map(t.invertX,t)),ct()},At=function(){if(!K.hasOwnProperty("x")||!K.hasOwnProperty("y"))throw"No X or Y columns specified in data set";tt||(ot=e.nest().key(t=>t[K.factor]).rollup(function(t){return+t.length}).object(Q),(Q=e.nest().key(t=>+t[K.x]).entries(Q).sort((t,e)=>t.key-e.key)).forEach(function(t){t.position=+t.key,delete t.key,t.total=+t.values.length})),Q.forEach(function(t){let n=e.nest().key(function(t){return t[K.factor]}).rollup(function(t){let n=t.filter(function(t){return t[K.factor]in ot});return{count:+n.length,byY:e.nest().key(function(t){return t[K.y]}).rollup(function(t){return+t.length}).entries(n).sort(function(t,e){return e.value-t.value})}}).entries(t.values).sort(function(t,e){return t.key>e.key});tt||(t._currentState={},t._currentState.showLabel=!1),t._currentState.count=e.sum(n.map(function(t){return t.value.count})),t._currentState.summary=n}),tt=!0,B=Q.map(function(t){return+t._currentState.count}).filter(function(t){return t>0}).sort(function(t,e){return t-e}),w=Math.ceil(e.quantile(B,Y.popParams.yLowerQuantile)),v=Math.floor(e.quantile(B,Y.popParams.yUpperQuantile)),et=[]},Dt=function(t){return e.scaleLinear().domain([0,t]).range([W,0]).nice().domain()[1]},_t=function(){E=0==B.length?[0,1]:e.extent(B),S=E[1]=Dt(E[1]*Y.yPaddingRatio)},Et=function(){_t(),N=e.scaleLinear().domain(E).range([W,0]),F=e.axisLeft(N).tickSize(-U).ticks(9),T=[0,J.length],L=e.scaleLinear().domain(T).range([0,j]),O=e.scaleLinear().domain(T).range([0,j]),D=function(t,e){if(void 0===e||t.length<=1||t[t.length-1]>=e)return t;var n=Math.abs(t[1]-t[0]);return Math.abs(e-t[t.length-1])>n/2?t.push(e):t[t.length-1]=e,t}(L.ticks(),J.length),A=e.axisBottom(L).tickValues(D).tickFormat(function(t){return this.parentNode.nextSibling?t:t+" aa"})},Nt=function(t,e){if(1!=(e=e||1)&&-1!=e&&(e=1),t=Dt(t*Y.yPaddingRatio),t=Math.max(S,t),1===e)et.push(t),et=et.sort();else{let e=et.indexOf(t);-1!=e&&(et=et.slice(0,e).concat(et.slice(e+1)))}let n=0==et.length?S:et[et.length-1];n!=E[1]&&(E[1]=n,Ft())},Ft=function(){N.domain(E),M.transition().duration(G.transitionTime).call(Bt),y.transition().duration(G.transitionTime).attr("y2",function(t){return dt(t)}),x.transition().duration(G.transitionTime).attr("transform",function(t){return"translate("+pt(t)+","+dt(t)+")"})},Bt=function(t){var e=t.selection?t.selection():t;t.call(F),e.select(".domain").remove(),e.selectAll(".tick line").filter(Number).attr("stroke","#aaa").attr("stroke-dasharray","2,2"),e.selectAll(".tick text").attr("x",-2).attr("dy",2),e!==t&&t.selectAll(".tick text").attrTween("x",null).attrTween("dy",null)},Mt=function(t,e,n,r){t.append("g").attr("id","background-layer").append("rect").attr("x",0).attr("y",0).attr("width",r).attr("height",n).attr("fill",e)},Pt=function(){(f=e.select(t).attr("width",$).attr("height",V).attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink")).classed(G.className,!0).style("background-color",G.background||"transparent"),m=f.append("g").attr("transform","translate("+G.margin.left+","+G.margin.top+")").attr("id",G.chartID),g=m.append("g").attr("id",Y.id),Mt(g,Y.background,W,U),h=m.append("g").attr("id",X.id).attr("transform","translate(0, "+(W+X.margin.top)+")"),Mt(h,X.background,H,j),G.tooltip&&(nt=u().attr("class","d3-tip").offset([8,0]).direction(function(t){return t.count>E[1]/2?"s":"n"}).offset(function(t){return t.count>E[1]/2?[16,0]:[-12,0]}).html(mt),g.call(nt))},zt={};return zt.options={set target(e){t=e},get target(){return t},set width(t){o=t},get width(){return o},set chartType(t){t&&t in s&&(a=t)},get chartType(){return a},get chartID(){return G.chartID},get height(){return+f.attr("height")},set margin(t){G.margin=t},get margin(){return G.margin},set background(t){G.background=t},get background(){return G.background},set transitionTime(t){G.transitionTime=t},get transitionTime(){return G.transitionTime},set tooltip(t){G.tooltip=t},get tooltip(){return G.tooltip},set ylab(t){Y.ylab.text=t},get ylab(){return Y.ylab.text},set axisLabelFont(t){Y.axisLabel.font=t},get axisLabelFont(){return Y.axisLabel.font},set axisLabelColor(t){Y.axisLabel.fill=t},get axisLabelColor(){return Y.axisLabel.fill},set axisLabelAlignment(t){Y.axisLabel.alignment=t},get axisLabelAlignment(){return Y.axisLabel.alignment},set axisLabelDy(t){Y.axisLabel.dy=t},get axisLabelDy(){return Y.axisLabel.dy},set showLegend(t){G.legend=t},get showLegend(){return G.legend},set legendMargin(t){G.legendOpt.margin=t},get legendMargin(){return G.legendOpt.margin},set legendInteractive(t){G.legendOpt.interactive=t},get legendInteractive(){return G.legendOpt.interactive},set legendTitle(t){G.legendOpt.title=t},get legendTitle(){return G.legendOpt.title},get legendHeight(){return R},get lollipopTrackID(){return Y.id},set lollipopTrackHeight(t){Y.height=t},get lollipopTrackHeight(){return Y.height},set lollipopTrackBackground(t){Y.background=t},get lollipopTrackBackground(){return Y.background},set lollipopPopMinSize(t){Y.popParams.rMin=t},get lollipopPopMinSize(){return Y.popParams.rMin},set lollipopPopMaxSize(t){Y.popParams.rMax=t},get lollipopPopMaxSize(){return Y.popParams.rMax},set lollipopPopInfoLimit(t){Y.popParams.addNumRCutoff=t},get lollipopPopInfoLimit(){return Y.popParams.addNumRCutoff},set lollipopPopInfoColor(t){Y.popText.fill=t},get lollipopPopInfoColor(){return Y.popText.fill},set lollipopLineColor(t){Y.lollipopLine.stroke=t},get lollipopLineColor(){return Y.lollipopLine.stroke},set lollipopLineWidth(t){Y.lollipopLine["stroke-width"]=t},get lollipopLineWidth(){return Y.lollipopLine["stroke-width"]},set lollipopCircleColor(t){Y.popCircle.stroke=t},get lollipopCircleColor(){return Y.popCircle.stroke},set lollipopCircleWidth(t){Y.popCircle["stroke-width"]=t},get lollipopCircleWidth(){return Y.popCircle["stroke-width"]},set lollipopLabelRatio(t){Y.popLabel.fontsizeToRadius=t},get lollipopLabelRatio(){return Y.popLabel.fontsizeToRadius},set lollipopLabelMinFontSize(t){Y.popLabel.minFontSize=t},get lollipopLabelMinFontSize(){return Y.popLabel.minFontSize},set lollipopColorScheme(t){Y.popColorScheme=t},get lollipopColorScheme(){return Y.popColorScheme},set titleText(t){Y.title.text=t},get titleText(){return Y.title.text},set titleFont(t){Y.title.font=t},get titleFont(){return Y.title.font},set titleColor(t){Y.title.color=t},get titleColor(){return Y.title.color},set titleAlignment(t){Y.title.alignment=t},get titleAlignment(){return Y.title.alignment},set titleDy(t){Y.title.dy=t},get titleY(){return Y.title.dy},get annoID(){return X.id},set annoHeight(t){X.height=t},get annoHeight(){return X.height},set annoMargin(t){X.margin=t},get annoMargin(){return X.margin},set annoBackground(t){X.background=t},get annoBackground(){return X.background},set annoBarFill(t){X.bar.background=t},get annoBarFill(){return X.bar.background},set annoBarMargin(t){X.bar.margin=t},get annoBarMargin(){return X.bar.margin},set domainColorScheme(t){X.domain.colorScheme=t},get domainColorScheme(){return X.domain.colorScheme},set domainMargin(t){X.domain.margin=t},get domainMargin(){return X.domain.margin},set domainTextFont(t){X.domain.label.font=t},get domainTextFont(){return X.domain.label.font},set domainTextColor(t){X.domain.label.color=t},get domainTextColor(){return X.domain.label.color},set brush(t){X.brush=t},get brush(){return X.brush},set zoom(t){X.zoom=t},get zoom(){return X.zoom}},zt.setOptions=function(t){for(let e in t)this.options[e]=t[e]},zt.getOptions=function(t){let e={},n=this;return t.forEach(function(t){n.options[t]&&(e[t]=n.options[t])}),e},zt.destroy=function(){(f=e.select(t)).attr("width",null).attr("height",null).attr("xmlns",null).attr("xmlns:xlink",null).classed(G.className,!1).style("background-color",null),f.selectAll("*").remove(),G.tooltip&&rt&&nt.destroy()},zt.refresh=function(){this.destroy(),this.draw(K,Z)},zt.data={set snvData(t){Q=t},get snvData(){return Q},set domainData(t){J=t},get domainData(){return J}},zt.draw=function(n,r){Z=r||d,(K=n||p).hasOwnProperty("factor")?at=!0:(at=!1,K.factor="__undefined__",Q.forEach(function(t){t[K.factor]="__undefined__"})),V=Y.height+X.height,$=o,W=Y.height-G.margin.top-G.margin.bottom,U=$-G.margin.left-G.margin.right,H=X.height-X.margin.top-X.margin.bottom,j=U,At(),Pt(),function(){let t,e;Et(),M=g.append("g").attr("class","axis axis--y").call(Bt),"start"==Y.axisLabel.alignment?(t="end",e=0):"middle"==Y.axisLabel.alignment?(t="middle",e=W/2):(t="start",e=W),g.append("text").attr("class","yaxis axis-label").attr("transform","translate(0,"+e+")rotate(-90)").style("font",Y.axisLabel.font).attr("fill",Y.axisLabel.fill).attr("text-anchor",t).attr("alignment-base","middle").attr("dy",Y.axisLabel.dy).text(Y.ylab.text),_=g.append("g").attr("clip-path","url(#"+Y.xAxisDefsId+")").attr("class","axis axis--x").attr("transform","translate(0, "+(W+X.height)+")").call(A)}(),g.append("clipPath").attr("id",Y.defsId).append("rect").attr("width",U).attr("height",W+X.margin.top),g.append("clipPath").attr("id",Y.xAxisDefsId).append("rect").attr("x",-5).attr("width",U+20).attr("height",30),h.append("clipPath").attr("id",X.defsId).append("rect").attr("width",j).attr("height",H),function(){let t=H-X.bar.margin.top-X.bar.margin.bottom;h.append("rect").classed(X.className.bar,!0).attr("x",0).attr("y",X.bar.margin.top).attr("width",j).attr("height",t).attr("fill",X.bar.background);let n=H-X.domain.margin.top-X.domain.margin.bottom,r=h.append("g").attr("class",X.className.track).selectAll(X.className.domain).data(J[Z.domainType]).enter().append("g").attr("clip-path","url(#"+X.defsId+")").attr("class",X.className.domain);k=r.append("rect").attr("x",function(t){return lt(t)}).attr("y",X.domain.margin.top).attr("height",n).attr("width",function(t){return it(t)}).attr("fill",function(t){return X.domain.colorScheme(t[Z.details.name])}),C=r.append("text").attr("x",function(t){return(lt(t)+st(t))/2}).attr("y",X.domain.margin.top+n/2).attr("dy","0.35em").attr("text-anchor","middle").attr("fill",X.domain.label.color||"white").style("font",X.domain.label.font).text(function(t){return t[Z.details.name]}),X.brush&&(z=e.brushX().extent([[0,0],[j,H]]).on("brush end",ut)),X.zoom&&(I=e.zoom().scaleExtent([1,1/0]).translateExtent([[0,0],[U,W]]).extent([[0,0],[U,W]]).on("zoom",Lt)),X.brush&&h.append("g").attr("class",X.className.brush).call(z),X.zoom&&g.append("rect").attr("class",X.className.zoom).attr("width",U).attr("height",W).attr("fill","none").attr("cursor","move").attr("pointer-events","all").call(I)}(),Tt(),G.legend&&function(){if(G.legend){P=new c(t),0==Object.keys(G.legendOpt.margin).length&&(G.legendOpt.margin={left:G.margin.left,right:G.margin.right,top:2,bottom:2}),P.margin=G.legendOpt.margin,P.interactive=G.legendOpt.interactive,P.title="__undefined__"===G.legendOpt.title?K.factor:G.legendOpt.title;for(let t in ot)P.addSeries({key:t,value:{fill:Y.popColorScheme(t),label:t+" ("+ot[t]+")"}});P.dispatch.on("legendClick",function(t,e){e?ot[t]=e:delete ot[t],At(),_t(),Ft(),x.each(wt)}),P.draw(),R=P.height}}(),X.brush&&h.select(".domain-x-brush").call(z.move,[0,j]),rt=!0},zt},Object.defineProperty(t,"__esModule",{value:!0})});